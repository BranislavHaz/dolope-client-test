import { useEffect } from "react";
import Head from "next/head";

import * as $ from "./index.styled";
import useWardrobeStore from "@/stores/wardrobeStore";

import Stand from "@/components/modules/stand";
import Module1 from "@/components/modules/module1";
import Module2 from "@/components/modules/module2";
import InputSelect from "@/components/modules/inputSelect";

const index = () => {
  const { section1, section2, section3, width, height, setViewportSize, mm } =
    useWardrobeStore((state) => ({
      width: state.width,
      height: state.height,
      setViewportSize: state.setViewportSize,
      mm: state.mm,
      section1: state.section1,
      section2: state.section2,
      section3: state.section3,
    }));

  useEffect(() => {
    setViewportSize({
      width: window.innerWidth,
      height: window.innerHeight,
    });

    const handleResize = () => {
      setViewportSize({
        width: window.innerWidth,
        height: window.innerHeight,
      });
    };

    window.addEventListener("resize", handleResize);

    return () => {
      window.removeEventListener("resize", handleResize);
    };
  }, []);

  return (
    <>
      <Head>
        <title>Nakonfigurujte si vlastnu skri≈àu</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <$.Main>
        <$.Wardrobe $width={mm * width} $height={mm * height}>
          <Stand />
          {section1 === 1 ? <Module1 /> : <Module2 />}
          <Stand />
          {section2 === 1 ? <Module1 /> : <Module2 />}
          <Stand />
          {section3 === 1 ? <Module1 /> : <Module2 />}
          <Stand />
        </$.Wardrobe>
        <$.Inputs>
          <InputSelect id={1} />
          <InputSelect id={2} />
          <InputSelect id={3} />
        </$.Inputs>
      </$.Main>
    </>
  );
};

export default index;
